var http = require('http').createServer();
var io=require('socket.io')(http);

http.listen(3000, () => {
    console.log("server started");
});

var players_count = 0;
var players = [];

io.sockets.on('connection',function(socket){
    console.log('one player connected'); // server side
    // socket.emit('text', 'wow. such event. very real time.');
    socket.on('newPlayer', (data) => {
        // socket.broadcast.emit('createNewPlayer', data); // for current players to load new player
        players.push(data);
        console.log(players);
        io.emit('createNewPlayer', players);
    });
    socket.on('goDown', (data)=>{
        if (players[data]['location_y'] <= 350){
            players[data]['location_y'] += 10;
        } else {
            players[data]['location_y'] = 360;
        }
        socket.broadcast.emit('goDown', data);
    });
    socket.on('goUp', (data)=>{
        if (players[data]['location_y'] >= 10){
            players[data]['location_y'] -= 10;
        } else {
            players[data]['location_y'] = 0;
        }
        socket.broadcast.emit('goUp', data);
    });
    socket.on('goLeft', (data)=>{
        if (players[data]['location_x'] >= 10){
            players[data]['location_x'] -= 10;
        } else {
            players[data]['location_x'] = 0;
        }
        socket.broadcast.emit('goLeft', data);
    });
    socket.on('goRight', (data)=>{
        if (players[data]['location_x'] <= 300){
            players[data]['location_x'] += 10;
        } else {
            players[data]['location_x'] = 310;
        }
        socket.broadcast.emit('goRight', data);
    });
});